<div class="shadow white-smoke card-rounded">
    {% if product.is_best_seller %}
    <span class="position-absolute-best-seller rounded">BEST SELLER <i class="fa-solid fa-award"></i></span>
    {% endif %}
    <div class="card border-0 card-rounded white-smoke p-1">
        <img
            src="{% if product.image %}{{ product.image.url }}{% else %}{{ MEDIA_URL }}no_image.png{% endif %}"
            class="card-img-top product-card-image card-rounded mb-4"
            alt="{% if product.name %}{{ product.name }}{% else %}Amelia Mae luxury product{% endif %}"
            >
        {% if product.is_out_of_stock %}
        <span class="out-of-stock-overlay card-rounded text-center">
            <i class="fa-solid fa-ban fa-flip-horizontal"></i>
            <p class="out-of-stock-text">Currently Out Of Stock</p>
        </span>
        {% endif %}
        <div class="card-body border-0 mb-0 white-smoke">
            <h5 class="card-title card-title-min-height-spacer mb-3">{{ product.name|truncatechars:50 }}</h5>
            <span class="product-card-price">Â£ {{ product.price }}</span>
            <a href="{% url 'product_detail' product.id %}" class="btn card-rounded shadow btn-outline-secondary d-flex justify-content-center stretched-link mt-3">View Product</a>
        </div>
    </div>
    <span class="position-absolute-rating">
        <i class="fa-sharp fa-solid fa-star {% if product.rating >= 1 %}gold{% else %}silver{% endif %}"></i>
        <i class="fa-sharp fa-solid fa-star {% if product.rating >= 1.5 %}gold{% else %}silver{% endif %}"></i>
        <i class="fa-sharp fa-solid fa-star {% if product.rating >= 2.5 %}gold{% else %}silver{% endif %}"></i>
        <i class="fa-sharp fa-solid fa-star {% if product.rating >= 3.5 %}gold{% else %}silver{% endif %}"></i>
        <i class="fa-sharp fa-solid fa-star {% if product.rating >= 4.5 %}gold{% else %}silver{% endif %}"></i>
    </span>
    <span class="position-absolute-favourite">
        {% if request.user.is_authenticated %}
            {% if product in favourite_products %}
                <a href="{% url 'delete_favourite' product.id %}?redirect={{ request.path }}"><i class="fa-solid fa-heart text-red"></i></a>
            {% else %}
                <a href="{% url 'add_favourite' product.id %}?redirect={{ request.path }}"><i class="fa-regular fa-heart text-red"></i></a>
            {% endif %}
        {% else %}
            <a href=""><i class="fa-regular fa-heart text-red"></i></a>
        {% endif %}
    </span>
    {% if product.is_discontinued and not product.is_out_of_stock %}
    <span class="ribbon ribbon-left px-5 shadow">Discontinued!<br>Only <strong>{{ product.quantity }}</strong> left</span>
    {% elif product.quantity >= 1 and product.quantity <= 25 %}
    <span class="ribbon ribbon-left px-5">Hurry!<br>Only <strong>{{ product.quantity }}</strong> left</span>
    {% endif %}
    <div class="card-footer white-smoke py-4 border-top-0 card-rounded">
        {% if product.quantity < 1 and not product.is_discontinued %}
        <a href="#" class="btn shadow btn-dark d-flex justify-content-center card-rounded">Restock Alert</a>
        <p class="mt-1 ml-1"><small>Get notified when this product is restocked!</small></p>
        {% elif product.quantity < 1 and product.is_discontinued %}
        <p class="py-1 my-1 shadow platinum d-flex justify-content-center card-rounded">Discontinued</p>
        {% else %}
        <form class="form" action="{% url 'quick_add_to_bag' product.id %}" method="POST">
            {% csrf_token %}
            <input type="submit"  class="btn shadow btn-dark w-100 d-flex justify-content-center card-rounded" value="Quick Add">
            <input type="hidden" name="redirect_url" value="{{ request.get_full_path }}">
        </form>
        {% endif %}
    </div>
</div>